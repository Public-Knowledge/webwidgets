<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"
	type="text/javascript"></script><script type="text/javascript">
function capitaliseFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}
var myOutput = "";
var repsData = new Object;
var sunlightURL = 'https://congress.api.sunlightfoundation.com/' +
    'legislators/locate';


function makeDivLink(url, text, options) {
	if (typeof options == 'object'){
		console.log("pre_text " + options.pre_text);	
		options = $.extend({ css_class: '', pre_text: '' }, options);
	} else {
		options = { css_class: '', pre_text: '', data_lang: '' };
	}
    console.log("*class " + options.css_class);

    return '<div>' + options.pre_text +
        '<a href="' + url + '" data-lang="' + options.data_lang + '" target="_blank" class="' + options.css_class +'">' + text + '</a></div>';
}

function repImageTag(bioguideID) {
    return '<img align="left" height="275" data-cke-saved-src="" src="' +
        "http://theunitedstates.io/images/congress/225x275/" +
        bioguideID + ".jpg" +
        '" style="margin: 2px 30px;" width="225" />';
}

function lookupPosition() {
    // This event fires when a button is clicked
    var zipValue = document.getElementById('myZip').value;
	console.log("zip: " + zipValue);
    // Clear out any existing data
    $('#congress_members').html("Working...");

    // Call the Sunlight API
    var query_params = {
        apikey: 'e595c253eb19468c9f12d743f77226f1', zip: zipValue
    };
    $.ajax(sunlightURL, {
        data: query_params, type: 'GET', dataType: 'jsonp',
        success: function(data){
            // Variable data constains the data we get from serverside
            //console.log("made an ajax call: " + data['results'][1]['title']);
            repsData = data['results'];
            makeRepHTML(repsData);
        }
        //end success function
    });

}

function makeRepHTML(repsData) {
    $('#congress_members').html('');
    for (var counter = 0; counter < repsData.length; counter++){
        var thisData = repsData[counter];
  
        bioIDLookup = repsData[counter]['bioguide_id'];
       
       

        var repFullName = thisData.title + ". " + thisData.first_name +
            " " + thisData.last_name;

        // Construct the output
        myOutput = '<br clear="all" /><p>' +
            repImageTag(thisData.bioguide_id) +
            '</p> <p><b>' + repFullName +
            "</b></p> <p>" + thisData.party + ", " +
            capitaliseFirstLetter(thisData.chamber) + "<br />";
       
            myOutput = myOutput +
                "Call " + repFullName + " at " + thisData.phone +
                " to ask them to stand up for Net Neutrality.<br /> ";
        
        var contactURL = thisData.contact_form;
        if (thisData.twitter_id) {
            var tweetURL = "https://twitter.com/intent/tweet?text=Please+support+net+neutrality&screen_name=" + thisData.twitter_id;
            myOutput += makeDivLink(tweetURL, 'Tweet', {
                    pre_text: "&nbsp; ",
                    css_class: 'twitter-mention-button',
                    data_lang: 'en'
                    });

        }
        $('#congress_members').append("<div class='member'>" +
                myOutput + "</div>");
        twttr.widgets.load();

    }
}
</script>
<p>&nbsp;</p>
<style type="text/css">.next { 
    background-color: #b32636;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius:6px;
    color: #fff;

    font-size: 20px;
    text-decoration: none;
    cursor: pointer;
    border:none;
    padding: 10px 20px;
 }
</style>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<div class="left"><b>Enter your Zip Code</b>
<form action="" method="post"><input id="myZip" size="5" type="text" value="" /> <input class="next" onclick="lookupPosition(); return false;" type="submit" value="Lookup" />&nbsp;</form>
&nbsp;</div>

<div class="right" id="congress_members">
<p>Without net neutrality rules, ISPs can slow down services such as Netflix and Hulu, or even redirect users from one website to a competing website. Companies can buy priority access to ISP customers. Large, wealthy companies such as Google or Facebook can pay ISPs to provide faster, more reliable access to their websites than to potential competitors. PK is fighting for the FCC to reclassify the internet as a telecommunications service under Title II, instead of the outdated current classification of information service. This reclassification is the only way for the FCC to have the authority to enforce net neutrality rules, which will allow customers to have consistent, reliable, and nondiscriminatory internet service.</p>
</div>

<div class="cb">&nbsp;</div>
